# E2E Test Configuration
# This configuration is used by the e2e test harness. It uses ephemeral ports
# and temporary filesystem paths so it is safe to run locally.

# Server Configuration
imap:
  # Port will be auto-assigned during tests
  listen_address: "127.0.0.1:0"
  # Tests exercise STARTTLS; test helpers generate self-signed certs and the
  # test IMAP client accepts the test certs (InsecureSkipVerify=true in tests).
  tls_enabled: true
  max_connections: 10
  timeout: "30s"
  idle_timeout: "60s"

lmtp:
  # Port will be auto-assigned during tests
  listen_address: "127.0.0.1:0"
  max_connections: 10
  timeout: "60s"

sasl:
  # Port will be auto-assigned during tests
  listen_address: "127.0.0.1:0"
  mechanisms: ["PLAIN", "LOGIN"]
  timeout: "30s"

# Database Configuration for E2E Tests
database:
  # Tests set an explicit temporary path (t.TempDir()) at runtime; leaving
  # this blank means the harness will create/assign a path.
  driver: "sqlite"
  path: ""
  connection_pool_size: 5
  max_idle_connections: 2
  max_open_connections: 10

# Test Domain Configuration
domains:
  - name: "e2e.test"
    enabled: true
    max_users: 100
    default_quota: "10MB"

# Logging Configuration for E2E Tests
logging:
  level: "debug"
  format: "json"
  output: "stderr"
  enable_caller: true

# Test Mode Flags
test_mode:
  enabled: true
  skip_authentication: false
  disable_external_calls: true
  fast_timeouts: true
  temp_data_cleanup: true

# Health Check Configuration
health:
  check_interval: "1s"
  timeout: "5s"
  retries: 30
